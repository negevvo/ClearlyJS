"use strict";function _defineProperty(a,b,c){return b in a?Object.defineProperty(a,b,{value:c,enumerable:!0,configurable:!0,writable:!0}):a[b]=c,a}Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=exports.clrly=exports.Switcher=exports.Switchable=exports.Sdiv=exports.Router=void 0;class clrly{static new(a="div",b,...d){if(b=b||{},"clrly"==a||"string"!=typeof a)return"string"!=typeof a&&(b.from=a),this._newElementFromComponent(b,d);var c=this._newElement(a);return this.editAttributes(c,b),this._appendChildrenToElement(c,d),c.editAttributes=function(a){return clrly.editAttributes(c,a)},c.isClearlyHTML=!0,c}static _appendChildrenToElement(b,c){if(c)for(var a of c)if(Array.isArray(a))this._appendChildrenToElement(b,a);else try{a.isClearlyComponent&&(a=a.HTML),b.appendChild(null==a.nodeType?document.createTextNode(a.toString()):a)}catch(d){}}static _newElement(b){var a=document.createElement(b);return document.body.appendChild(a),a}static _newElementFromComponent(b,e){var c=b.from;if(!c)throw new Error("Cannot find the component");b.children=e;var a=new c(b),d=a.element;return a.style&&(d.style=a.style),a.HTML=d,a.isClearlyComponent=!0,a.start&&a.start(b),a}static editAttributes(b,a){if(Array.isArray(b)){for(var e of b)this.editAttributes(e,a);return b}if(a){var f=b.isClearlyComponent;for(var c in a){if("parent"!=c&&"innerHTML"!=c){var d=typeof a[c];"function"==d||"object"==d||f?b[c]=a[c]:b.setAttribute(c,a[c])}a.parent&&a.parent.appendChild(b),a.innerHTML&&(b.innerHTML=a.innerHTML)}}return b}static add(a,b=document.documentElement){try{return b.innerHTML+=a,a}catch(c){}}static id(a){return this.Xid(document,a)}static class(a){return this.Xclass(document,a)}static tag(a){return this.Xtag(document,a)}static select(a){return this.Xselect(document,a)}static attribute(a,b){return this.Xattribute(document,a,b)}static import(a,b,c){return Array.isArray(a)||(a=[a]),this._importRec(a,b,c,0),a}static _importRec(e,c,g,f){var a,b=e[f];for(var d in a=b.includes(".css")?this.new("link",{parent:document.head,href:b,rel:"stylesheet"}):this.new("script",{parent:document.head,src:b}),c)a.setAttribute(d,c[d]);a.onload=function(){f===e.length-1?g&&g():clrly._importRec(e,d,g,f+1)}}static title(a){return document.title=a}static ogTitle(a){return Array.from(this.attribute("property","og:title")).forEach(function(a){a.remove()}),this.new("meta",{parent:document.head,property:"og:title",content:a}),this.attribute("property","og:title")[0].href}static description(a){return Array.from(this.attribute("name","description")).forEach(function(a){a.remove()}),this.new("meta",{parent:document.head,name:"description",content:a}),this.attribute("name","description")[0].href}static ogDescription(a){return Array.from(this.attribute("property","og:description")).forEach(function(a){a.remove()}),this.new("meta",{parent:document.head,property:"og:description",content:a}),this.attribute("property","og:description")[0].href}static icon(a){return Array.from(this.attribute("rel","icon")).forEach(function(a){a.remove()}),this.new("link",{parent:document.head,rel:"icon",href:a}),this.attribute("rel","icon")[0].href}static ogImage(a){return Array.from(this.attribute("property","og:image")).forEach(function(a){a.remove()}),this.new("meta",{parent:document.head,property:"og:image",content:a}),this.attribute("property","og:image")[0].href}static theme(a){return Array.from(this.attribute("name","theme-color")).concat(Array.from(this.attribute("name","apple-mobile-web-app-status-bar-style"))).forEach(function(a){a.remove()}),this.new("meta",{parent:document.head,name:"theme-color",content:a}),this.new("meta",{parent:document.head,name:"apple-mobile-web-app-status-bar-style",content:a}),this.attribute("name","theme-color")[0].content}static dir(a){document.body.dir=a}static mobileFriendly(a=!0){return this.new("meta",{parent:document.head,name:"viewport",content:`width=device-width, initial-scale=1.0${"app"==a?", user-scalable=no":""}`})}static initialize(a){var b=[];return a.title&&b.push(this.title(a.title)),a.ogTitle&&b.push(this.ogTitle(a.ogTitle)),a.description&&b.push(this.description(a.description)),a.ogDescription&&b.push(this.ogDescription(a.ogDescription)),a.icon&&b.push(this.icon(a.icon)),a.ogImage&&b.push(this.ogImage(a.ogImage)),a.theme&&b.push(this.theme(a.theme)),a.dir&&b.push(this.dir(a.dir)),a.mobile&&b.push(this.mobileFriendly(a.mobile)),b}static style(a){return this.new("style",{parent:document.head,innerHTML:a})}static toRGB(a){a=3==a.length?a.replace(/(.)/g,"$1$1"):a;var b=/^#?([a-f\d]{2})([a-f\d]{2})([a-f\d]{2})$/i.exec(a);return b?{r:parseInt(b[1],16),g:parseInt(b[2],16),b:parseInt(b[3],16)}:""}static toHEX(a){function b(a){return 1==(a=a.toString(16)).length?"0"+a:a}return"#"+b(a.r)+b(a.g)+b(a.b)}static colorBrightness(c,a){var b=this.toRGB(c);return a=(a+100)/100,this.toHEX({r:Math.min(255,Math.floor(b.r*a)),g:Math.min(255,Math.floor(b.g*a)),b:Math.min(255,Math.floor(b.b*a))})}static get url(){return window.location.href}static get pageUrl(){return this.url.replace(window.location.search,"").replace(window.location.hash,"")}static get hash(){return decodeURI(window.location.hash.substring(1))}static get search(){return new URL(window.location.href).searchParams}static reload(){window.location.reload()}static redirect(a){window.location.replace(a)}static go(a,b){b?window.open(a):window.location.href=a}static duplicate(){this.go(this.url,!0)}static pageURL(){this.go(this.pageUrl)}static get _MONTHS(){return["JAN","FEB","MAR","APR","MAY","JUN","JUL","AUG","SEP","OCT","NOV","DEC"]}static cookie(f,b,c,a,d){var e="31 Dec 2036";return void 0!==c&& void 0!==a&& void 0!==d&&(e=c+" "+(a=this._MONTHS[a-1])+" "+d),document.cookie=f+"="+b+"; expires="+e+" 23:59:59 UTC; path=/",b}static deleteCookie(a){document.cookie=a+"=; expires=Thu, 01 Jan 1970 00:00:01 GMT; path=/"}static getCookie(e){for(var c=e+"=",d=decodeURIComponent(document.cookie).split(";"),b=0;b<d.length;b++){for(var a=d[b];" "==a.charAt(0);)a=a.substring(1);if(0==a.indexOf(c))return a.substring(c.length,a.length)}return""}static ajax(a,b,c){fetch(a,b).then(a=>a.text()).then(a=>c(a))}static json(a,b,c){fetch(a,b).then(a=>a.json()).then(a=>c(a))}static getXML(b,c){var a=new XMLHttpRequest;a.onreadystatechange=function(){4==this.readyState&&200==this.status&&c(this.responseXML)},a.open("GET",b,!0),a.send()}static Xid(a,b){try{return a.getElementById(b)}catch(c){return}}static Xclass(a,b){try{return a.getElementsByClassName(b)}catch(c){return[]}}static Xtag(a,b){try{return a.getElementsByTagName(b)}catch(c){return[]}}static Xselect(a,b){try{return a.querySelectorAll(b)}catch(c){return[]}}static Xattribute(a,b,c){try{return this.Xselect(a,"["+b+'="'+c+'"]')}catch(d){return[]}}static Xvalue(a){return a.firstChild.nodeValue}static random(a,b){return Math.random()*(b-a)+a}static randomInt(a,b){return Math.floor(Math.random()*(b-a+1))+a}static toFile(a,b="text/html"){return URL.createObjectURL(new Blob([a],{type:b}))}static download(b,c){var a=this.new("a",{href:b,download:c});a.click(),a.remove()}}exports.clrly=exports.default=clrly,_defineProperty(clrly,"component",class{constructor(a){if(this.constructor===clrly.component)throw new Error("clrly.component is not an initializeable object, make your own component")}start(){}get element(){throw new Error("get element() does not exist")}get style(){return""}update(b=!0){var a=this.element;a.style=this.style,this.HTML.parentNode.replaceChild(a,this.HTML),this.HTML=a,b&&this.start()}registerUpdate(a,c,d){var b=this;b[a]||(b[a]={}),b[a]=new Proxy(b[a],{set:function(f,a,e){return f[a]=e,b.update(c),d&&d(a,e),!0}})}unregisterUpdate(a){this[a]={...this[a]}}});class Switchable extends clrly.component{constructor(a){super(a)}appendTo(a,b={}){this.switcherParent=a,this.sProps=b,this.start(),this.update()}start(){this.HTML.editAttributes({parent:this.switcherParent})}onSwitch(){}get isSwitchable(){return!0}}exports.Switchable=Switchable;class _SwitcherRouterBase extends clrly.component{constructor(a){super(a),this.state=a,this.registerUpdate("state"),this.clear()}set current(a){this.state.current=a}}class Switcher extends _SwitcherRouterBase{get element(){let b=clrly.new("div"),a=this.state.current||{i:0,props:{}};if(0==this.screens.length)return b;if(a.i>this.screens.length||a.i<1)a.i=1;else{let c=this.screens[a.i-1];c.isSwitchable&&(c.appendTo(b,a.props),c.onSwitch())}return b}addScreen(a){return this.screens.push(a),a.HTML.remove(),this.screens.length}get currentId(){return this.state.current.i}clear(){this.screens=[]}}exports.Switcher=Switcher;class Router extends _SwitcherRouterBase{static get NOT_FOUND_PATH(){return"/404"}constructor(a){super(a),window.onpopstate=this.init}get element(){let b=clrly.new("div"),a=this.state.current;if(this.routes=={}||null==a)return b;let c=this.routes[a.route]||this.routes[Router.NOT_FOUND_PATH];return c.isSwitchable&&(window.history.pushState({},"",a.route),c.appendTo(b,a.props),c.onSwitch()),b}addRoute(a,b){return this.routes[a]=b,b.HTML.remove(),a}get currentRoute(){return this.state.current.route}clear(){this.routes={},this.addRoute(Router.NOT_FOUND_PATH,this.state.notFound)}async init(){this.current={route:window.location.pathname,props:{}}}}exports.Router=Router;class Sdiv extends Switchable{constructor(a){super(a),this.state=a,this.registerUpdate("state")}get element(){return clrly.new("div",{},...this.state.children)}onSwitch(){this.state.onSwitch&&this.state.onSwitch()}}exports.Sdiv=Sdiv
